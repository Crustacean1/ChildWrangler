{
  "db_name": "PostgreSQL",
  "query": "WITH affected_attendance AS (SELECT DISTINCT ON (ea.day,ea.meal_id,ea.target) ea.day, ea.meal_id, ea.target,group_relations.level FROM attendance AS src\n        INNER JOIN group_relations ON group_relations.child = src.target\n        INNER JOIN effective_attendance AS ea ON ea.day = src.day AND ea.meal_id = src.meal_id AND ea.target= group_relations.parent\n        WHERE src.cause_id  = $1 AND ea.value = false\n        ORDER BY ea.day, ea.meal_id, ea.target, group_relations.level)\n        SELECT students.name AS student_name, meals.name AS meal_name, COUNT(*) AS cancelled FROM affected_attendance \n        INNER JOIN students ON students.id = affected_attendance.target\n        INNER JOIN meals ON meals.id = affected_attendance.meal_id\n        WHERE level = 0\n        GROUP BY students.id, meals.id",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "student_name",
        "type_info": "Text"
      },
      {
        "ordinal": 1,
        "name": "meal_name",
        "type_info": "Text"
      },
      {
        "ordinal": 2,
        "name": "cancelled",
        "type_info": "Int8"
      }
    ],
    "parameters": {
      "Left": [
        "Uuid"
      ]
    },
    "nullable": [
      false,
      false,
      null
    ]
  },
  "hash": "1611c932eb9fd6b16a4ef1c58c79621b03c92b720c908607ab7d33672f3bb827"
}
